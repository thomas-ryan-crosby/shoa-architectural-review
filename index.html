<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanctuary HOA Architectural Review Generator</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Sanctuary HOA Architectural Review Generator</h1>
            <p class="subtitle">Generate professional approval letters for architectural reviews</p>
            <button type="button" id="standardsButton" class="standards-button">Refresher on SHOA Arch Standards</button>
        </header>

        <main>
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button type="button" class="tab-button active" data-tab="generate">Generate Letter</button>
                <button type="button" class="tab-button" data-tab="projects">Project Overview</button>
            </div>

            <!-- Generate Letter Tab -->
            <div class="tab-content active" id="generateTab">
            <form id="reviewForm">
                <!-- Project Information Section -->
                <section class="form-section">
                    <h2>Project Information</h2>
                    
                    <div class="form-group">
                        <label for="ownerLastName">
                            Property Owner Last Name <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="ownerLastName" 
                            name="ownerLastName" 
                            required 
                            placeholder="e.g., Smith"
                        >
                        <span class="error-message" id="ownerLastName-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="address">
                            Property Address <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="address" 
                            name="address" 
                            required 
                            placeholder="e.g., 113 Juniper Court"
                        >
                        <span class="error-message" id="address-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="lot">
                            Lot Number <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="lot" 
                            name="lot" 
                            required 
                            placeholder="e.g., 434"
                        >
                        <span class="error-message" id="lot-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="contractorName">
                            Contractor Name
                        </label>
                        <input 
                            type="text" 
                            id="contractorName" 
                            name="contractorName" 
                            placeholder="e.g., ABC Construction"
                        >
                        <span class="error-message" id="contractorName-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="projectType">
                            Project Type <span class="required">*</span>
                        </label>
                        <select id="projectType" name="projectType" required>
                            <option value="">Select a project type...</option>
                            <option value="New Home">New Home</option>
                            <option value="Renovation/Extension">Renovation/Extension</option>
                            <option value="Accessory Structure">Accessory Structure</option>
                            <option value="Pool">Pool</option>
                            <option value="Other">Other</option>
                        </select>
                        <span class="error-message" id="projectType-error"></span>
                    </div>

                    <div class="form-group" id="otherProjectTypeGroup" style="display: none;">
                        <label for="otherProjectType">
                            Specify Project Type <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="otherProjectType" 
                            name="otherProjectType" 
                            placeholder="Enter project type"
                        >
                        <span class="error-message" id="otherProjectType-error"></span>
                    </div>
                </section>

                <!-- File Upload Section -->
                <section class="form-section">
                    <h2>Current Site Conditions</h2>
                    <p class="section-description">Attach image of Google Maps or site picture (optional but recommended)</p>
                    
                    <div class="file-upload-area" id="siteConditionsUploadArea">
                        <input 
                            type="file" 
                            id="siteConditionsInput" 
                            name="siteConditionsFiles" 
                            multiple 
                            accept=".pdf,.jpg,.jpeg,.png"
                        >
                        <div class="upload-prompt">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            <p>Click to upload or drag and drop files here</p>
                            <p class="file-types">PDF, JPG, PNG</p>
                        </div>
                    </div>

                    <div class="file-list" id="siteConditionsFileList"></div>
                </section>

                <section class="form-section">
                    <h2>Submitted Project Files</h2>
                    <p class="section-description">Upload project documents, plans, or drawings (optional but recommended)</p>
                    
                    <div class="file-upload-area" id="projectFilesUploadArea">
                        <input 
                            type="file" 
                            id="projectFilesInput" 
                            name="projectFiles" 
                            multiple 
                            accept=".pdf,.jpg,.jpeg,.png,.doc,.docx"
                        >
                        <div class="upload-prompt">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            <p>Click to upload or drag and drop files here</p>
                            <p class="file-types">PDF, JPG, PNG, DOC, DOCX</p>
                        </div>
                    </div>

                    <div class="file-list" id="projectFilesFileList"></div>
                </section>

                <!-- Review Details Section -->
                <section class="form-section">
                    <h2>Review Details</h2>
                    
                    <div class="form-group">
                        <label for="reviewCommentsType">
                            Review Comments <span class="required">*</span>
                        </label>
                        <select id="reviewCommentsType" name="reviewCommentsType" required>
                            <option value="default">The plan was reviewed for Sanctuary Setback Requirements.</option>
                            <option value="other">Other (specify below)</option>
                        </select>
                        <span class="error-message" id="reviewCommentsType-error"></span>
                    </div>

                    <div class="form-group" id="otherReviewCommentsGroup" style="display: none;">
                        <label for="reviewComments">
                            Specify Review Comments <span class="required">*</span>
                        </label>
                        <textarea 
                            id="reviewComments" 
                            name="reviewComments" 
                            rows="4"
                            placeholder="Enter your review comments"
                        ></textarea>
                        <span class="error-message" id="reviewComments-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="approvalReasonType">
                            Approval Reason <span class="required">*</span>
                        </label>
                        <select id="approvalReasonType" name="approvalReasonType" required>
                            <option value="default">The project meets Sanctuary Setback Requirements. No variances are required. Approved.</option>
                            <option value="other">Other (specify below)</option>
                        </select>
                        <span class="error-message" id="approvalReasonType-error"></span>
                    </div>

                    <div class="form-group" id="otherApprovalReasonGroup" style="display: none;">
                        <label for="approvalReason">
                            Specify Approval Reason <span class="required">*</span>
                        </label>
                        <textarea 
                            id="approvalReason" 
                            name="approvalReason" 
                            rows="4"
                            placeholder="Enter your approval reason"
                        ></textarea>
                        <span class="error-message" id="approvalReason-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="approvedBy">
                            Approved By
                        </label>
                        <input 
                            type="text" 
                            id="approvedBy" 
                            name="approvedBy" 
                            placeholder="e.g., John Smith, AECC Chair"
                        >
                        <span class="error-message" id="approvedBy-error"></span>
                    </div>
                </section>

                <!-- Submit Button -->
                <div class="form-actions">
                    <button type="submit" id="generateBtn" class="btn-primary">
                        <span class="btn-text">Generate Approval Letter</span>
                        <span class="btn-loading" style="display: none;">
                            <span class="spinner"></span> Generating PDF...
                        </span>
                    </button>
                </div>
            </form>
            </div>

            <!-- Project Overview Tab -->
            <div class="tab-content" id="projectsTab" style="display: none;">
                <section class="form-section">
                    <h2>Project Tracking</h2>
                    
                    <div class="project-filters">
                        <button type="button" class="filter-btn active" data-filter="all">All Projects</button>
                        <button type="button" class="filter-btn" data-filter="open">Open</button>
                        <button type="button" class="filter-btn" data-filter="previous">Previous</button>
                    </div>

                    <!-- Add Project Form -->
                    <div class="add-project-section">
                        <button type="button" class="btn-secondary" id="toggleAddProjectBtn">
                            <span id="toggleAddProjectText">+ Add Existing Project</span>
                        </button>
                        
                        <div class="add-project-form" id="addProjectForm" style="display: none;">
                            <h3>Add Existing Project</h3>
                            <div class="form-group">
                                <label for="addHomeownerName">
                                    Homeowner Name <span class="required">*</span>
                                </label>
                                <input 
                                    type="text" 
                                    id="addHomeownerName" 
                                    name="addHomeownerName" 
                                    required 
                                    placeholder="e.g., Smith"
                                >
                                <span class="error-message" id="addHomeownerName-error"></span>
                            </div>

                            <div class="form-group">
                                <label for="addAddress">
                                    Property Address
                                </label>
                                <input 
                                    type="text" 
                                    id="addAddress" 
                                    name="addAddress" 
                                    placeholder="e.g., 113 Juniper Court"
                                >
                            </div>

                            <div class="form-group">
                                <label for="addLot">
                                    Lot Number
                                </label>
                                <input 
                                    type="text" 
                                    id="addLot" 
                                    name="addLot" 
                                    placeholder="e.g., 434"
                                >
                            </div>

                            <div class="form-group">
                                <label for="addProjectType">
                                    Project Type
                                </label>
                                <input 
                                    type="text" 
                                    id="addProjectType" 
                                    name="addProjectType" 
                                    placeholder="e.g., Pool, New Home"
                                >
                            </div>

                            <div class="form-group">
                                <label for="addDateApproved">
                                    Date Approved <span class="required">*</span>
                                </label>
                                <input 
                                    type="date" 
                                    id="addDateApproved" 
                                    name="addDateApproved" 
                                    required
                                >
                                <span class="error-message" id="addDateApproved-error"></span>
                            </div>

                            <div class="form-group">
                                <label for="addDateConstructionStarted">
                                    Date Construction Started
                                </label>
                                <input 
                                    type="date" 
                                    id="addDateConstructionStarted" 
                                    name="addDateConstructionStarted"
                                >
                            </div>

                            <div class="form-group">
                                <label for="addProjectStatus">
                                    Status <span class="required">*</span>
                                </label>
                                <select id="addProjectStatus" name="addProjectStatus" required>
                                    <option value="open">Open</option>
                                    <option value="previous">Previous</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="addApprovalLetter">
                                    Upload Approval Letter PDF <span class="required">*</span>
                                </label>
                                <input 
                                    type="file" 
                                    id="addApprovalLetter" 
                                    name="addApprovalLetter" 
                                    accept=".pdf"
                                    required
                                >
                                <span class="error-message" id="addApprovalLetter-error"></span>
                                <small class="form-hint">Upload the previously issued architectural approval letter</small>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="btn-primary" id="saveProjectBtn">Save Project</button>
                                <button type="button" class="btn-secondary" id="cancelAddProjectBtn">Cancel</button>
                            </div>
                        </div>
                    </div>

                    <div class="project-list" id="projectList">
                        <!-- Projects will be dynamically added here -->
                    </div>

                    <div class="no-projects" id="noProjects" style="display: none;">
                        <p>No projects found. Projects will appear here after you generate approval letters or add existing projects.</p>
                    </div>
                </section>
            </div>
        </main>

        <footer>
            <p>Sanctuary Homeowners Association Architectural Review Committee</p>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <!-- Standards Modal -->
    <div class="modal-overlay" id="standardsModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Consolidated Setback & Site Improvement Standards</h2>
                <p class="modal-subtitle">(Phases 1A – Phase 5)</p>
                <button class="modal-close" id="closeStandardsModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="standards-content">
                    <section class="standards-section">
                        <h3>I. Primary Residential Building Setbacks</h3>
                        
                        <div class="phase-section">
                            <h4>Phase 1A</h4>
                            <ul>
                                <li><strong>Front</strong>
                                    <ul>
                                        <li>Lots 11–14: 30 ft</li>
                                        <li>All other lots: 40 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Side</strong>
                                    <ul>
                                        <li>Corner side: 25 ft</li>
                                        <li>Interior side (except where shown): 20 ft</li>
                                        <li>Interior side (where shown): 15 ft</li>
                                        <li>Corner side (no access): 5 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Rear</strong>
                                    <ul>
                                        <li>40 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Special</strong>
                                    <ul>
                                        <li>Lot 27: setbacks as shown on plan</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 1A1</h4>
                            <ul>
                                <li><strong>Front:</strong> 40 ft</li>
                                <li><strong>Side (interior):</strong> 15 ft</li>
                                <li><strong>Rear</strong>
                                    <ul>
                                        <li>Standard: 40 ft</li>
                                        <li>Lot 29 only: 30 ft</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 1B</h4>
                            <ul>
                                <li><strong>Front:</strong> 40 ft</li>
                                <li><strong>Side</strong>
                                    <ul>
                                        <li>Corner side: 25 ft</li>
                                        <li>Interior side (except where shown): 20 ft</li>
                                        <li>Interior side (where shown): 15 ft</li>
                                        <li>Corner side (no access): 5 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Rear:</strong> 40 ft</li>
                                <li><strong>Lots with special side setbacks:</strong> Lots 64, 65, 75–85, 92, 93, 115, 116</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 1C</h4>
                            <ul>
                                <li><strong>Front:</strong> 40 ft</li>
                                <li><strong>Side (interior):</strong> 15 ft or 20 ft (as shown)</li>
                                <li><strong>Rear:</strong> 40 ft</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 2</h4>
                            <ul>
                                <li><strong>Front:</strong> 50 ft</li>
                                <li><strong>Side</strong>
                                    <ul>
                                        <li>Corner side: 40 ft</li>
                                        <li>Interior side (except where shown): 40 ft</li>
                                        <li>Interior side (where shown): 30 ft</li>
                                        <li>Corner side (no access): 5 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Rear:</strong> 75 ft</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 3A</h4>
                            <ul>
                                <li><strong>Front:</strong> 50 ft</li>
                                <li><strong>Side</strong>
                                    <ul>
                                        <li>Corner side: 40 ft</li>
                                        <li>Interior side (except where shown): 40 ft</li>
                                        <li>Interior side (where shown): 30 ft</li>
                                        <li>Corner side (no access): 5 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Rear:</strong> 65 ft</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 3B</h4>
                            <ul>
                                <li><strong>Front:</strong> 50 ft</li>
                                <li><strong>Side</strong>
                                    <ul>
                                        <li>Corner side: 40 ft</li>
                                        <li>Interior side (except where shown): 40 ft</li>
                                        <li>Interior side (where shown): 30 ft or 35 ft</li>
                                        <li>Corner side (no access): 5 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Rear:</strong> 65 ft</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 4A</h4>
                            <p><strong>0.5± Acre Lots</strong></p>
                            <ul>
                                <li><strong>Front:</strong> 40 ft (30 ft where shown)</li>
                                <li><strong>Side:</strong>
                                    <ul>
                                        <li>Corner: 25 ft</li>
                                        <li>Interior: 20 ft (15 ft where shown)</li>
                                    </ul>
                                </li>
                                <li><strong>Rear:</strong> 40 ft</li>
                            </ul>
                            <p><strong>1.0± Acre Lots</strong></p>
                            <ul>
                                <li><strong>Front:</strong> 50 ft</li>
                                <li><strong>Side:</strong>
                                    <ul>
                                        <li>Corner: 40 ft</li>
                                        <li>Interior: 40 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Rear:</strong> 65 ft</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 4B</h4>
                            <p><strong>Standard Lots</strong></p>
                            <ul>
                                <li><strong>Front:</strong> 30 ft</li>
                                <li><strong>Side:</strong> 15 ft</li>
                                <li><strong>Rear:</strong> 30 ft</li>
                            </ul>
                            <p><strong>Lot 412</strong></p>
                            <ul>
                                <li><strong>Front:</strong> 40 ft</li>
                                <li><strong>Side:</strong> 30 ft</li>
                                <li><strong>Rear:</strong> 40 ft</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 4C</h4>
                            <p><strong>Standard (unless otherwise shown)</strong></p>
                            <ul>
                                <li><strong>Front:</strong> 30 ft</li>
                                <li><strong>Side:</strong> 15 ft</li>
                                <li><strong>Rear:</strong> 30 ft</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Phase 5</h4>
                            <p><strong>Standard (unless otherwise shown)</strong></p>
                            <ul>
                                <li><strong>Front:</strong> 30 ft</li>
                                <li><strong>Side:</strong> 15 ft</li>
                                <li><strong>Rear:</strong> 30 ft</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <p><strong>Governing Rule</strong></p>
                            <p>CLURO, approved PUD, or private provisions — whichever is more restrictive</p>
                        </div>
                    </section>

                    <section class="standards-section">
                        <h3>II. Accessory Improvements – Pools, Patios, & Courts</h3>
                        
                        <div class="phase-section">
                            <h4>Uncovered Improvements</h4>
                            <p>(Pools, tennis courts, uncovered patios)</p>
                            <ul>
                                <li><strong>Rear Setback</strong>
                                    <ul>
                                        <li>Lots &lt; 40,000 SF: 10 ft</li>
                                        <li>Lots ≥ 40,000 SF: 20 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Side Setback</strong>
                                    <ul>
                                        <li>Same as required for the primary dwelling</li>
                                    </ul>
                                </li>
                                <li><strong>Exceptions</strong>
                                    <ul>
                                        <li>AECC may grant exceptions upon site plan review</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Covered Improvements</h4>
                            <p>(Covered patios & structures)</p>
                            <ul>
                                <li><strong>Rear Setback</strong>
                                    <ul>
                                        <li>Lots &lt; 40,000 SF: 20 ft</li>
                                        <li>Lots ≥ 40,000 SF: 40 ft</li>
                                    </ul>
                                </li>
                                <li><strong>Side Setback</strong>
                                    <ul>
                                        <li>Same as required for the primary dwelling</li>
                                    </ul>
                                </li>
                                <li><strong>Exceptions</strong>
                                    <ul>
                                        <li>AECC approval required</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </section>

                    <section class="standards-section">
                        <h3>III. Swimming Pool & Pool Deck Standards</h3>
                        <ul>
                            <li>Must be located on the rear portion of the lot</li>
                            <li>Not visible from any street</li>
                            <li>Must be in-ground and at normal ground level</li>
                            <li>Pools are not required to be below 9.5 feet above mean sea level</li>
                            <li>Fill must be added as necessary to create an in-ground appearance</li>
                            <li>Pools must be fully enclosed by an AECC-approved fence compliant with all applicable ordinances</li>
                        </ul>
                    </section>

                    <section class="standards-section">
                        <h3>IV. Playground & Recreational Equipment</h3>
                        <p>(Playscapes, swing sets, monkey bars, play gyms)</p>
                        <ul>
                            <li><strong>Maximum height:</strong> 12 ft</li>
                            <li><strong>Location:</strong> Rear yard only</li>
                            <li><strong>Setbacks</strong>
                                <ul>
                                    <li>Lots &lt; 40,000 SF: 20 ft from rear & side</li>
                                    <li>Lots ≥ 40,000 SF: 40 ft from rear & side</li>
                                </ul>
                            </li>
                            <li><strong>Exceptions</strong>
                                <ul>
                                    <li>AECC may grant variances upon request and site plan review</li>
                                </ul>
                            </li>
                        </ul>
                    </section>

                    <section class="standards-section">
                        <h3>V. Driveway Design & Location Standards</h3>
                        
                        <div class="phase-section">
                            <h4>Recommended materials</h4>
                            <ul>
                                <li>Pervious materials (gravel, loose pavers)</li>
                                <li>Gravel/Limestone
                                    <ul>
                                        <li>Must be bordered by AECC-approved edging</li>
                                        <li>Maximum width: 16 ft</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Location</h4>
                            <ul>
                                <li>Driveways shall not encroach into side yard setback areas</li>
                            </ul>
                        </div>

                        <div class="phase-section">
                            <h4>Garage-adjacent paved parking</h4>
                            <ul>
                                <li>Max width: equal to garage</li>
                                <li>Max depth: 25 ft</li>
                            </ul>
                        </div>
                    </section>

                    <section class="standards-section">
                        <h3>VI. Hierarchy of Control</h3>
                        <p>All development and improvements shall comply with:</p>
                        <ol>
                            <li>Plat-specific requirements</li>
                            <li>Approved PUD / CLURO</li>
                            <li>Private covenants and AECC determinations</li>
                        </ol>
                        <p><strong>The most restrictive standard shall govern.</strong></p>
                    </section>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="closeStandardsModalBtn">Close</button>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner-large"></div>
            <p>Generating your approval letter...</p>
        </div>
    </div>

    <!-- Preload logo for better reliability -->
    <img id="logoPreload" src="assets/logo/sanctuary logo.jpg" style="display: none;" alt="Sanctuary Logo" onload="console.log('Logo preloaded successfully')" onerror="console.error('Logo preload failed')">

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="js/logo-data.js"></script>
    <script src="js/builders-rules-data.js"></script>
    <script src="js/form-handler.js"></script>
    <script src="js/file-handler.js"></script>
    <script src="js/pdf-generator.js"></script>
    <script src="js/project-manager.js"></script>
    <script src="js/app.js"></script>
</body>
</html>

